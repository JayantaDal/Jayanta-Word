<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Word Clone</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.0.3/docx.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: #f5f5f5; padding: 20px; }
        .toolbar { margin-bottom: 10px; }
        button, select, input { margin: 5px; padding: 8px; border-radius: 5px; cursor: pointer; }
        #editor { width: 80%; margin: auto; padding: 10px; background: white; min-height: 500px; border: 1px solid black; overflow: auto; text-align: left; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid black; padding: 5px; text-align: center; word-wrap: break-word; overflow: hidden; }
        img { max-width: 100%; height: auto; }
    </style>
</head>
<body>

    <h2>Microsoft Word Clone</h2>

    <div class="toolbar">
        <button onclick="document.execCommand('bold')">Bold</button>
        <button onclick="document.execCommand('italic')">Italic</button>
        <input type="color" onchange="document.execCommand('foreColor', false, this.value)">
        <select onchange="document.execCommand('fontSize', false, this.value)">
            <option value="1">8px</option>
            <option value="2">10px</option>
            <option value="3">12px</option>
            <option value="4">14px</option>
            <option value="5">18px</option>
            <option value="6">24px</option>
            <option value="7">36px</option>
        </select>
        <button onclick="document.execCommand('undo')">Undo</button>
        <button onclick="document.execCommand('redo')">Redo</button>
        <button onclick="document.execCommand('cut')">Cut</button>
        <button onclick="document.execCommand('copy')">Copy</button>
        <button onclick="document.execCommand('paste')">Paste</button>
        <button onclick="document.execCommand('insertUnorderedList')">Bullet</button>
        <button onclick="document.execCommand('insertOrderedList')">Numbering</button>
        <button onclick="document.execCommand('justifyLeft')">Left</button>
        <button onclick="document.execCommand('justifyCenter')">Center</button>
        <button onclick="document.execCommand('justifyRight')">Right</button>
        <button onclick="document.execCommand('justifyFull')">Justify</button>
        <button onclick="insertTable()">Insert Table</button>
        <button onclick="insertImage()">Insert Image</button>
        <button onclick="exportToPDF('portrait')">Save as PDF (Portrait)</button>
        <button onclick="exportToPDF('landscape')">Save as PDF (Landscape)</button>
        <button onclick="exportToDocx()">Save as DOCX</button>
    </div>

    <div id="editor" contenteditable="true"></div>

    <script>
        function insertTable() {
            let rows = prompt("Enter number of rows:");
            let cols = prompt("Enter number of columns:");
            if (rows > 0 && cols > 0) {
                let table = "<table>";
                for (let i = 0; i < rows; i++) {
                    table += "<tr>";
                    for (let j = 0; j < cols; j++) {
                        table += "<td contenteditable='true'></td>";
                    }
                    table += "</tr>";
                }
                table += "</table>";
                document.execCommand('insertHTML', false, table);
            } else {
                alert("Invalid input!");
            }
        }

        function insertImage() {
            let input = document.createElement("input");
            input.type = "file";
            input.accept = "image/*";
            input.onchange = function () {
                let file = input.files[0];
                let reader = new FileReader();
                reader.onload = function (e) {
                    let img = `<img src="${e.target.result}" contenteditable="false" style="max-width:300px">`;
                    document.execCommand('insertHTML', false, img);
                };
                reader.readAsDataURL(file);
            };
            input.click();
        }

        function exportToPDF(orientation) {
            const { jsPDF } = window.jspdf;
            let doc = new jsPDF({ orientation: orientation });

            let editor = document.getElementById("editor");

            html2canvas(editor).then(canvas => {
                let imgData = canvas.toDataURL("image/png");
                let imgWidth = orientation === "portrait" ? 210 : 297;
                let imgHeight = (canvas.height * imgWidth) / canvas.width;

                doc.addImage(imgData, "PNG", 10, 10, imgWidth - 20, imgHeight);
                doc.save("Word_Document.pdf");
            });
        }

        function exportToDocx() {
            let { Document, Packer, Paragraph, TextRun } = window.docx;
            let doc = new Document();
            let editor = document.getElementById("editor");

            let paragraphs = Array.from(editor.childNodes).map(node => {
                if (node.nodeType === Node.TEXT_NODE) {
                    return new Paragraph(new TextRun(node.textContent));
                } else if (node.tagName === "TABLE") {
                    let tableRows = Array.from(node.rows).map(row =>
                        new TableRow({
                            children: Array.from(row.cells).map(cell =>
                                new TableCell({
                                    children: [new Paragraph(cell.textContent)]
                                })
                            )
                        })
                    );
                    return new Table({ rows: tableRows });
                } else {
                    return new Paragraph(new TextRun(node.innerText));
                }
            });

            doc.addSection({ children: paragraphs });

            Packer.toBlob(doc).then(blob => {
                let link = document.createElement("a");
                link.href = URL.createObjectURL(blob);
                link.download = "Word_Document.docx";
                link.click();
            });
        }
    </script>

</body>
</html>
